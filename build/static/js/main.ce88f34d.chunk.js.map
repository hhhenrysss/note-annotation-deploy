{"version":3,"sources":["network/endpoints.js","components/authentication.js","components/document-space.js","utils/markdown.js","components/comment-tip.js","components/pdf-viewer.js","utils/color.js","components/comment-display.js","components/document-viewer.js","App.js","reportWebVitals.js","index.js"],"names":["strip","result","data","endpoints","login","async","username","password","axios","post","register","role","getDocuments","get","params","modifyDocument","getAllHighlights","id","createDocument","doc","addHighlight","highlight","comment","externalDocs","upvoteHighlight","isCancel","addComment","targetId","deleteDocument","deleteComment","BaseLayout","children","title","onRegisterClick","style","width","height","display","flexDirection","justifyContent","background","paddingBottom","alignSelf","margin","padding","textAlign","color","fontWeight","fontSize","Button","onClick","marginLeft","paddingTop","Login","onAuthenticated","setUsername","useState","setPassword","history","useHistory","push","marginBottom","TextField","fullWidth","variant","label","onChange","e","target","value","type","then","user","Register","setRole","FormControl","component","FormLabel","RadioGroup","aria-label","name","FormControlLabel","control","Radio","DocumentAdd","onAdd","setDoc","key","old","minWidth","url","access","marginRight","newDoc","creationDate","Date","now","lastUpdatedDate","author","uuidv4","toString","AppHeader","onAddDocument","isDialogOpen","setIsDialogOpen","alignItems","IconButton","AddOutlined","window","location","reload","textTransform","blue","borderRadius","Dialog","open","onClose","DocumentCard","info","existingDocInfo","onDelete","Card","minHeight","CardContent","CardActions","selectedDoc","red","DocumentSpace","userRole","documents","setDocuments","useEffect","addedDoc","gridTemplateColumns","gridGap","map","d","shouldEnableDelete","onDeleteDocument","newDocs","markdownConverter","Showdown","tables","simplifiedAutoLink","strikethrough","tasklists","InternalLinkAdd","onSelect","setValue","suggestions","setSuggestions","getSuggestionValue","onSuggestionsFetchRequested","filter","toLowerCase","includes","onSuggestionsClearRequested","renderSuggestion","suggestion","maxWidth","onSuggestionSelected","inputProps","placeholder","newValue","renderInputComponent","props","ExternalLinkAdd","setUrl","setName","inputLabelProps","LinkAdd","links","isInternalLink","setIsInternalLink","flexWrap","gap","marginTop","l","Chip","textOverflow","v","CommentTip","onOpen","hasTitle","content","setContent","editorTab","setEditorTab","setTitle","setAccess","setLinks","backdropFilter","boxShadow","Close","selectedTab","onTabChange","generateMarkdownPreview","markdown","Promise","resolve","makeHtml","isExternal","ls","setPdfWorker","PDFWorker","resetHash","document","hash","LoadingIndicator","CircularProgress","PDFViewer","highlights","onAddHighlight","position","beforeLoad","pdfDocument","enableAreaSelection","event","altKey","onScrollChange","scrollRef","onSelectionFinished","hideTipAndSelection","transformSelection","selectedText","highlightTransform","index","setTip","hideTip","viewportToScaled","screenshot","isScrolledTo","Boolean","image","boundingRect","popupContent","onMouseOver","onMouseOut","hexToRgb","hex","bigint","parseInt","replace","getHexGradient","hexStart","hexEnd","weight","w1","w2","rgbStart","rgbEnd","rgb","x","length","join","rgbToHex","Math","round","CommentMinimizedDisplay","className","borderBottom","cursor","dangerouslySetInnerHTML","__html","generateDocumentChips","allLinkedInternalDocs","allLinkedExternalDocs","onUpdateDocument","chips","docId","linkedDocuments","NestedReplies","commentId","allComments","allUsers","nestingLevel","currentUsername","stopPropagation","replies","borderLeft","replyId","CommentDisplay","onClickUpvote","onAddComment","isUpvoted","setIsUpvoted","clickedReply","setClickedReply","selectedComment","console","log","overflowY","flexGrow","ThumbUp","ThumbUpOutlined","upvotes","text","Add","InfoOutlined","DocumentInfo","onUpdateInfo","mode","setMode","documentName","setDocumentName","toLocaleDateString","filterMode","Object","freeze","self","student","instructor","DocumentViewer","state","setDocument","values","setValues","isSettingOpen","setIsSettingOpen","highlightsFilter","setHighlightsFilter","selectedHighlight","setSelectedHighlight","val","filteredHighlights","filteredUsers","users","generateSelection","combined","time","documentId","externalLinks","link","comments","linkedExternalResources","s","SettingsOutlined","row","defaultValue","Select","MenuItem","u","h","PaperProps","maxHeight","shouldUpvote","newValues","i","isFound","theme","createMuiTheme","palette","primary","main","blueGrey","secondary","typography","fontFamily","ProtectedRoute","path","defined","notDefined","exact","App","setUser","to","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.ce88f34d.chunk.js","sourcesContent":["import axios from 'axios';\nimport {Button} from \"@material-ui/core\";\n\nfunction strip(result) {\n    return result.data.data;\n}\n\nasync function login(username, password) {\n    const results = await axios.post('/api/login', {username, password});\n    return strip(results);\n}\n\nasync function register(username, password, role) {\n    const results = await axios.post('/api/register', {username, password, role});\n    return strip(results);\n}\n\nasync function getDocuments(username) {\n    const results = await axios.get('/api/pdfs', {params: {username}});\n    return strip(results);\n}\n\nasync function modifyDocument(data) {\n    const results = await axios.post('/api/pdf/edit', data);\n    return strip(results);\n}\n\nasync function createDocument(doc) {\n    const results = await axios.post('/api/pdf/create', doc);\n    return strip(results);\n}\n\nasync function deleteDocument(id) {\n    const results = await axios.post('/api/pdf/delete', {id});\n    return strip(results);\n}\n\nasync function getAllHighlights(id, username) {\n    const results = await axios.get('/api/highlights', {params: {id, username}});\n    return strip(results)\n}\n\nasync function addHighlight(highlight, comment, externalDocs) {\n    const results = await axios.post('/api/highlight/add', {highlight, comment, externalDocs});\n    return strip(results);\n}\n\nasync function upvoteHighlight(id, isCancel) {\n    const results = await axios.post('/api/highlight/upvote', {id, isCancel});\n    return strip(results);\n}\n\nasync function addComment(targetId, comment, externalDocs) {\n    const results = await axios.post('/api/comment/add', {targetId, comment, externalDocs});\n    return strip(results);\n}\n\nasync function deleteComment(id) {\n    const results = await axios.post('/api/comment/delete', {id});\n    return strip(results);\n}\n\nexport const endpoints = {login, register, getDocuments, modifyDocument, getAllHighlights, createDocument,\n    addHighlight, upvoteHighlight, addComment, deleteDocument, deleteComment}","import {useState} from \"react\";\nimport {endpoints} from \"../network/endpoints\";\nimport {TextField, Button, FormLabel, RadioGroup, FormControlLabel, Radio, FormControl} from \"@material-ui/core\";\nimport {useHistory} from \"react-router-dom\";\n\n\nfunction BaseLayout({children, title, onRegisterClick}) {\n    return (\n        <div style={{width: '100%', height: '100%'}}>\n            <section style={{display: 'flex', flexDirection: 'row', justifyContent: 'center', height: 'calc(40% - 25px)', width: '100%', background: 'black', paddingBottom: 25}}>\n                <div style={{width: '40%', display: 'flex', flexDirection: 'row'}}>\n                    <h1 style={{alignSelf: 'flex-end', margin: 0, padding: 0, textAlign: 'start', color: 'white', fontWeight: 300, fontSize: 40}}>{title}</h1>\n                    {onRegisterClick && (<Button onClick={onRegisterClick} style={{alignSelf: 'flex-end', marginLeft: \"auto\", color: 'white'}}>Register</Button>)}\n                </div>\n            </section>\n            <section style={{display: 'flex', justifyContent: 'center', height: 'calc(60% - 25px)', width: '100%', paddingTop: 25}}>\n                <div style={{width: '40%'}}>{children}</div>\n            </section>\n        </div>\n    )\n}\n\nexport function Login({onAuthenticated}) {\n    const [username, setUsername] = useState(null);\n    const [password, setPassword] = useState(null);\n    const history = useHistory();\n\n    const authenticate = () => {\n        if (!username || !password) {\n            return;\n        }\n        endpoints.login(username, password).then(user => {\n            if (user) {\n                onAuthenticated(user)\n            }\n        });\n    }\n    return (\n        <BaseLayout title='Login' onRegisterClick={() => history.push('/register')}>\n            <form>\n                <div style={{marginBottom: 10}}>\n                    <TextField fullWidth variant='filled' label='Username' onChange={e => setUsername(e.target.value)}/>\n                </div>\n                <div style={{marginBottom: 20}}>\n                    <TextField type='password' fullWidth variant='filled' label='Password' onChange={e => setPassword(e.target.value)}/>\n                </div>\n                <div style={{display: 'flex'}}>\n                    <Button onClick={authenticate} style={{marginLeft: 'auto'}}>Submit</Button>\n                </div>\n            </form>\n        </BaseLayout>\n    )\n}\n\nexport function Register({onAuthenticated}) {\n    const [username, setUsername] = useState(null);\n    const [password, setPassword] = useState(null);\n    const [role, setRole] = useState('student');\n    const authenticate = () => {\n        if (!username || !password || !role) {\n            return;\n        }\n        endpoints.register(username, password, role).then(user => {\n            if (user) {\n                onAuthenticated(user)\n            }\n        });\n    }\n    return (\n        <BaseLayout title='Register'>\n            <form>\n                <div style={{marginBottom: 10}}>\n                    <TextField fullWidth variant='filled' label='Username' onChange={e => setUsername(e.target.value)}/>\n                </div>\n                <div style={{marginBottom: 20}}>\n                    <TextField type='password' fullWidth variant='filled' label='Password' onChange={e => setPassword(e.target.value)}/>\n                </div>\n                <div style={{marginBottom: 20}}>\n                    <FormControl component=\"fieldset\">\n                        <FormLabel component=\"legend\">Role</FormLabel>\n                        <RadioGroup style={{display: \"flex\", flexDirection: 'row'}} aria-label=\"gender\" name=\"access-level\" value={role} onChange={e => setRole(e.target.value)}>\n                            <FormControlLabel value=\"instructor\" control={<Radio />} label='Instructor' />\n                            <FormControlLabel value=\"student\" control={<Radio />} label='Student' />\n                        </RadioGroup>\n                    </FormControl>\n                </div>\n                <div style={{display: 'flex'}}>\n                    <Button onClick={authenticate} style={{marginLeft: 'auto'}}>Submit</Button>\n                </div>\n            </form>\n        </BaseLayout>\n    )\n}","import {useEffect, useState} from \"react\";\nimport {\n    Button,\n    Card,\n    CardActions,\n    CardContent,\n    Dialog, FormControl, FormControlLabel,\n    FormLabel,\n    IconButton, Radio,\n    RadioGroup,\n    TextField\n} from \"@material-ui/core\";\nimport {blue, red} from \"@material-ui/core/colors\";\nimport {endpoints} from \"../network/endpoints\";\nimport {useHistory} from 'react-router-dom';\nimport {AddOutlined} from \"@material-ui/icons\";\nimport { v4 as uuidv4 } from 'uuid';\n\nfunction DocumentAdd({onAdd, username}) {\n    const [doc, setDoc] = useState({})\n    const onChange = (e, key) => {\n        setDoc(old => ({...old, [key]: e.target.value}));\n    }\n    const onSubmit = () => {\n        const newDoc = {...doc};\n        newDoc.creationDate = Date.now()\n        newDoc.lastUpdatedDate = Date.now()\n        newDoc.author = username;\n        newDoc.id = `document-${uuidv4().toString()}`\n        onAdd(newDoc)\n    }\n    return (\n        <div style={{padding: 15, minWidth: 300}}>\n            <h1 style={{fontWeight: 500, fontSize: 20}}>Add New Document</h1>\n            <form>\n                <div style={{marginBottom: 10}}>\n                    <TextField fullWidth label='Document name' value={doc.name} onChange={e => onChange(e, 'name')}/>\n                </div>\n                <div style={{marginBottom: 20}}>\n                    <TextField fullWidth label='Url' value={doc.url} onChange={e => onChange(e, 'url')}/>\n                </div>\n                <div style={{marginBottom: 20}}>\n                    <FormControl fullWidth component=\"fieldset\">\n                        <FormLabel component=\"legend\">Role</FormLabel>\n                        <RadioGroup style={{display: \"flex\", flexDirection: 'row'}} aria-label=\"gender\" name=\"access-level\" value={doc.access} onChange={e => onChange(e, 'access')}>\n                            <FormControlLabel value=\"private\" control={<Radio />} label='Private' />\n                            <FormControlLabel value=\"public\" control={<Radio />} label='Public' />\n                        </RadioGroup>\n                    </FormControl>\n                </div>\n                <div style={{display: 'flex'}}>\n                    <Button style={{marginLeft: \"auto\", marginRight: 0}} onClick={onSubmit}>Submit</Button>\n                </div>\n            </form>\n        </div>\n    )\n}\n\nfunction AppHeader({username, onAddDocument}) {\n    const [isDialogOpen, setIsDialogOpen] = useState(false);\n    const onAdd = doc => {\n        setIsDialogOpen(false);\n        onAddDocument(doc)\n    }\n    return (\n        <>\n            <div style={{background: 'black', width: '100%', display: 'flex', alignItems: 'center', height: 48}}>\n                <h2 style={{color: 'white', fontSize: 18, padding: '5px 15px', margin: 0, fontWeight: 500}}>All Documents</h2>\n                <IconButton style={{marginLeft: 'auto'}} onClick={() => setIsDialogOpen(true)}><AddOutlined style={{color: 'white'}}/></IconButton>\n                <Button onClick={() => window.location.reload()} style={{ color: '#fff1ff', textTransform: 'none', background: blue['700'], height: '100%', borderRadius: 0}}>{username}</Button>\n            </div>\n            <Dialog open={isDialogOpen} onClose={() => setIsDialogOpen(false)}>\n                <DocumentAdd onAdd={onAdd} username={username}/>\n            </Dialog>\n        </>\n    )\n}\n\nfunction DocumentCard({info, existingDocInfo, onDelete}) {\n    const history = useHistory();\n    const onNavigate = () => {\n        history.push(`/pdf/${info.id}`, {selectedDoc: info, existingDocInfo})\n    }\n    return (\n        <Card style={{display: \"flex\", flexDirection: 'column', justifyContent: \"space-between\", minHeight: 220}}>\n            <CardContent>\n                <h3 style={{fontWeight: 300, margin: 0, marginBottom: 10}}>{info.name}</h3>\n                <p style={{margin: 0, color: \"gray\"}}>Uploaded by {info.author}</p>\n            </CardContent>\n            <CardActions>\n                <Button onClick={onNavigate}>View Document</Button>\n                {onDelete && (\n                    <Button onClick={onDelete} style={{color: red['500'], marginLeft: 'auto'}}>Delete</Button>\n                )}\n            </CardActions>\n        </Card>\n    )\n}\n\nexport function DocumentSpace({username, userRole}) {\n    const [documents, setDocuments] = useState([]);\n    useEffect(() => {\n        endpoints.getDocuments(username).then(setDocuments);\n    }, []);\n    const onAddDocument = doc => {\n        endpoints.createDocument(doc).then(addedDoc => setDocuments(old => [...old, addedDoc]));\n    }\n    const onDeleteDocument = id => {\n        endpoints.deleteDocument(id).then(() => setDocuments(old => {\n            const newDocs = [];\n            for (const d of old) {\n                if (d.id !== id) {\n                    newDocs.push(d);\n                }\n            }\n            return newDocs\n        }))\n    }\n    return (\n        <div style={{width: '100vw', height: '100vh', display: 'flex', flexDirection: 'column'}}>\n            <AppHeader username={username} onAddDocument={onAddDocument}/>\n            <div style={{display: \"grid\", gridTemplateColumns: \"repeat(4, 1fr)\", gridGap: 15, padding: 15}}>\n                {documents.map(d => {\n                    let shouldEnableDelete = false;\n                    if (userRole === 'student') {\n                        if (d.author === username) {\n                            shouldEnableDelete = true;\n                        }\n                    } else {\n                        shouldEnableDelete = true;\n                    }\n                    return (\n                        <DocumentCard\n                            key={d.id}\n                            info={d}\n                            existingDocInfo={documents.map(({name, id}) => ({name, id}))}\n                            onDelete={shouldEnableDelete ? () => onDeleteDocument(d.id) : null}\n                        />\n                    )\n                })}\n            </div>\n        </div>\n    )\n}","import * as Showdown from \"showdown\";\n\nexport const markdownConverter = new Showdown.Converter({\n    tables: true,\n    simplifiedAutoLink: true,\n    strikethrough: true,\n    tasklists: true\n});","import {\n    Button,\n    TextField,\n    FormControl,\n    RadioGroup,\n    FormControlLabel,\n    FormLabel,\n    Radio,\n    Chip,\n    IconButton\n} from \"@material-ui/core\";\n\nimport ReactMde from \"react-mde\";\nimport {useState} from \"react\";\n\nimport \"react-mde/lib/styles/css/react-mde-all.css\";\nimport {markdownConverter} from \"../utils/markdown\";\nimport Autosuggest from 'react-autosuggest';\nimport { v4 as uuidv4 } from 'uuid';\nimport {Close} from \"@material-ui/icons\";\n\nfunction InternalLinkAdd({onSelect, existingDocInfo}) {\n    const [value, setValue] = useState('');\n    const [suggestions, setSuggestions] = useState([]);\n    const getSuggestions = ({value}) => {\n        setSuggestions(existingDocInfo.filter(d => d.name.toLowerCase().includes(value.toLowerCase())))\n    }\n    return (\n        <Autosuggest\n            suggestions={suggestions}\n            getSuggestionValue={d => d.name}\n            onSuggestionsFetchRequested={getSuggestions}\n            onSuggestionsClearRequested={() => setSuggestions([])}\n            renderSuggestion={suggestion => <div style={{maxWidth: 450, fontSize: 12}}>{suggestion.name}</div>}\n            onSuggestionSelected={(e, {suggestion}) => onSelect(suggestion)}\n            inputProps={{\n                placeholder: 'Search resource name',\n                value,\n                onChange: (e, {newValue}) => setValue(newValue)\n            }}\n            style={{fontSize: 12}}\n            renderInputComponent={props => (<TextField fullWidth inputProps={{style: {fontSize: 12}}} {...props}/>)}\n        />\n    )\n}\n\nfunction ExternalLinkAdd({onAdd, username}) {\n    const [url, setUrl] = useState('');\n    const [name, setName] = useState('');\n    const onSubmit = () => {\n        onAdd({\n            url, name, creationDate: Date.now(), lastUpdatedDate: Date.now(), author: username, id: `external-${uuidv4().toString()}`\n        })\n    }\n    return (\n        <>\n            <div style={{marginBottom: 10}}>\n                <TextField inputLabelProps={{style: {fontSize: 12}}} inputProps={{style: {fontSize: 12}}} fullWidth value={url} onChange={e => setUrl(e.target.value)} label='URL'/>\n            </div>\n            <div style={{marginBottom: 10}}>\n                <TextField inputLabelProps={{style: {fontSize: 12}}} inputProps={{style: {fontSize: 12}}} fullWidth value={name} onChange={e => setName(e.target.value)} label='Name'/>\n            </div>\n            <div style={{display: \"flex\"}}>\n                <Button style={{marginLeft: 'auto'}} onClick={onSubmit}>Add</Button>\n            </div>\n        </>\n    )\n}\n\n\nfunction LinkAdd({onAdd, onDelete, links, existingDocInfo, username}) {\n    const [isInternalLink, setIsInternalLink] = useState(true);\n    return (\n        <>\n            <FormLabel component=\"legend\" style={{fontSize: 12}}>Links to resources</FormLabel>\n            <div style={{display: 'flex', flexWrap: \"wrap\", gap: 10, marginTop: 10}}>\n                {links.map(l => <Chip\n                    style={{textOverflow: \"ellipsis\", maxWidth: 150}}\n                    variant='outlined'\n                    key={l.id}\n                    label={l.name}\n                    onDelete={() => onDelete(l.id)}\n                />)}\n            </div>\n            <Button fullWidth onClick={() => setIsInternalLink(v => !v)}>{isInternalLink ? 'Add Link to External Resource' : 'Add Link to Internal Resource'}</Button>\n            {isInternalLink ? (\n                <InternalLinkAdd existingDocInfo={existingDocInfo} onSelect={({name, id}) => onAdd({id, name}, false)}/>\n            ) : (\n                <ExternalLinkAdd username={username} onAdd={l => onAdd(l, true)}/>\n            )}\n        </>\n    )\n}\n\n\nexport function CommentTip({onAdd, onOpen, username, existingDocInfo, hasTitle, onClose}) {\n    const [content, setContent] = useState('');\n    const [editorTab, setEditorTab] = useState('write');\n    const [title, setTitle] = useState('');\n    const [access, setAccess] = useState('private');\n    const [links, setLinks] = useState([]);\n    const onAddLink = (data, isExternal) => {\n        setLinks(old => {\n            const ls = [...old];\n            for (const {id} of ls) {\n                if (id === data.id) {\n                    return ls;\n                }\n            }\n            ls.push({\n                name: data.name,\n                id: data.id,\n                isExternal,\n                data\n            })\n            return ls\n        })\n    }\n    const onDeleteLink = id => {\n        setLinks(old => old.filter(d => d.id !== id));\n    }\n    const onAddComment = () => onAdd({title, content, access, links})\n    return (\n        <div style={{background: 'rgba(255,255, 255, 0.8)', backdropFilter: 'blur(10px)', padding: 10, boxShadow: '0 6.4px 14.4px 0 rgb(0 0 0 / 13%), 0 1.2px 3.6px 0 rgb(0 0 0 / 11%)'}}>\n            <div style={{padding: '10px 0', display: 'flex', flexDirection: 'row', alignItems: 'center'}}>\n                <h3 style={{fontWeight: 500, margin: 0}}>New comments</h3>\n                <Button style={{marginLeft: 'auto'}} onClick={onAddComment}>Post</Button>\n                {onClose && (\n                    <IconButton onClick={onClose}><Close/></IconButton>\n                )}\n            </div>\n            <form>\n                {hasTitle && (\n                    <TextField style={{marginBottom: 10}} fullWidth label={'Title'} value={title} onChange={e => setTitle(e.target.value)}/>\n                )}\n                <div style={{maxWidth: 500, marginBottom: 20}}>\n                    <ReactMde\n                        value={content}\n                        onChange={setContent}\n                        selectedTab={editorTab}\n                        onTabChange={setEditorTab}\n                        generateMarkdownPreview={markdown => Promise.resolve(markdownConverter.makeHtml(markdown))}\n                    />\n\n                </div>\n                <br/>\n                <div style={{marginBottom: 20}}>\n                    <FormControl component=\"fieldset\">\n                        <FormLabel component=\"legend\" style={{fontSize: 12}}>Access Level</FormLabel>\n                        <RadioGroup style={{display: \"flex\", flexDirection: 'row'}} aria-label=\"gender\" name=\"access-level\" value={access} onChange={e => setAccess(e.target.value)}>\n                            <FormControlLabel style={{fontSize: 12}} value=\"private\" control={<Radio />} label={<span style={{fontSize: 12}}>Private</span>} />\n                            <FormControlLabel value=\"public\" control={<Radio />} label={<span style={{fontSize: 12}}>Public</span>} />\n                        </RadioGroup>\n                    </FormControl>\n                </div>\n                <br/>\n                <div style={{marginBottom: 10}}>\n                    <LinkAdd onAdd={onAddLink} onDelete={onDeleteLink} links={links} existingDocInfo={existingDocInfo} username={username}/>\n                </div>\n\n            </form>\n        </div>\n    )\n}","/* eslint import/no-webpack-loader-syntax: 0 */\n\nimport {AreaHighlight, Highlight, PdfHighlighter, PdfLoader, Popup, Tip, setPdfWorker} from \"react-pdf-highlighter\";\nimport PDFWorker from \"worker-loader!pdfjs-dist/lib/pdf.worker\";\n\n\nimport {useCallback, useState} from \"react\";\nimport {CommentTip} from \"./comment-tip\";\nimport {CircularProgress} from \"@material-ui/core\";\n\nsetPdfWorker(PDFWorker);\n\nconst resetHash = () => {\n    document.location.hash = \"\";\n};\n\nfunction LoadingIndicator() {\n    return (\n        <div style={{display: 'flex', justifyContent: \"center\", alignItems: \"center\", height: '100%'}}>\n            <CircularProgress />\n        </div>\n    )\n}\n\nexport function PDFViewer({url, highlights, onAddHighlight, username, existingDocInfo}) {\n    return (\n        <div style={{width: '100%', height: '100%', position: 'relative'}}>\n            <PdfLoader url={url} beforeLoad={<LoadingIndicator/>}>\n                {pdfDocument => (\n                    <PdfHighlighter\n                        pdfDocument={pdfDocument}\n                        enableAreaSelection={event => event.altKey}\n                        onScrollChange={resetHash}\n                        // pdfScaleValue=\"page-width\"\n                        scrollRef={() => {}}\n                        onSelectionFinished={(\n                            position,\n                            content,\n                            hideTipAndSelection,\n                            transformSelection\n                        ) => (\n                            <CommentTip\n                                onOpen={transformSelection}\n                                onAdd={comment => {\n                                    onAddHighlight({selectedText: content, position, comment});\n                                    hideTipAndSelection();\n                                }}\n                                username={username}\n                                existingDocInfo={existingDocInfo}\n                                hasTitle={true}\n                            />\n                        )}\n                        highlightTransform={(\n                            highlight,\n                            index,\n                            setTip,\n                            hideTip,\n                            viewportToScaled,\n                            screenshot,\n                            isScrolledTo\n                        ) => {\n                            const isTextHighlight = !Boolean(\n                                highlight.content && highlight.content.image\n                            );\n\n                            const component = isTextHighlight ? (\n                                <Highlight\n                                    isScrolledTo={isScrolledTo}\n                                    position={highlight.position}\n                                    comment={highlight.comment}\n                                />\n                            ) : (\n                                <AreaHighlight\n                                    highlight={highlight}\n                                    onChange={boundingRect => {\n                                        // updateHighlight(\n                                        //     highlight.id,\n                                        //     {boundingRect: viewportToScaled(boundingRect)},\n                                        //     {image: screenshot(boundingRect)}\n                                        // );\n                                    }}\n                                />\n                            );\n\n                            return (\n                                <Popup\n                                    popupContent={<div/>}\n                                    onMouseOver={popupContent =>\n                                        setTip(highlight, highlight => popupContent)\n                                    }\n                                    onMouseOut={hideTip}\n                                    key={index}\n                                    children={component}\n                                />\n                            );\n                        }}\n                        highlights={highlights}\n                    />\n                )}\n            </PdfLoader>\n        </div>\n    )\n}","function hexToRgb(hex) {\n    const bigint = parseInt(hex.replace('#', ''), 16);\n    const r = (bigint >> 16) & 255;\n    const g = (bigint >> 8) & 255;\n    const b = bigint & 255;\n    return [r, g, b]\n}\n\nfunction rgbToHex(rgb) {\n    return '#' + rgb.map(x => {\n        const hex = x.toString(16)\n        return hex.length === 1 ? '0' + hex : hex\n    }).join('')\n}\n\nexport function getHexGradient(hexStart, hexEnd, weight) {\n    const w1 = weight;\n    const w2 = 1 - w1;\n    const rgbStart = hexToRgb(hexStart)\n    const rgbEnd = hexToRgb(hexEnd)\n    const rgb = [Math.round(rgbStart[0] * w1 + rgbEnd[0] * w2),\n        Math.round(rgbStart[1] * w1 + rgbEnd[1] * w2),\n        Math.round(rgbStart[2] * w1 + rgbEnd[2] * w2)];\n    return rgbToHex(rgb)\n}","import {markdownConverter} from \"../utils/markdown\";\nimport {useState} from \"react\";\nimport {Add, Close, ThumbUp, ThumbUpOutlined} from \"@material-ui/icons\";\nimport {Button, Chip, IconButton} from \"@material-ui/core\";\nimport {useHistory} from \"react-router-dom\";\nimport {getHexGradient} from \"../utils/color\";\nimport {CommentTip} from \"./comment-tip\";\nimport {red} from \"@material-ui/core/colors\";\n\nexport function CommentMinimizedDisplay({title, username, content, onClick}) {\n    return (\n        <div className={'hover-card'} onClick={onClick} style={{padding: 10, borderBottom: '1px solid #c7c7c7', cursor: \"pointer\"}}>\n            <h6 style={{fontSize: 15, margin: '5px 0'}}>{title}</h6>\n            <p style={{fontSize: 12, color: 'gray', marginBottom: 5, margin: 0, padding: '5px 0'}}>{username}</p>\n            <div style={{fontSize: 12, margin: 0, padding: 0}} dangerouslySetInnerHTML={{__html: markdownConverter.makeHtml(content)}}/>\n        </div>\n    )\n}\n\nfunction generateDocumentChips(comment, allLinkedInternalDocs, allLinkedExternalDocs, history, onUpdateDocument) {\n    const chips = []\n    if (!comment) {\n        return []\n    }\n    for (const docId of comment.linkedDocuments) {\n        if (docId in allLinkedInternalDocs) {\n            const doc = allLinkedInternalDocs[docId]\n            chips.push(<Chip\n                style={{textOverflow: \"ellipsis\", maxWidth: 150}}\n                label={doc.name}\n                variant='outlined'\n                color={'secondary'}\n                key={docId}\n                onClick={() => onUpdateDocument(doc)}\n            />)\n        } else if (docId in allLinkedExternalDocs) {\n            const doc = allLinkedExternalDocs[docId]\n            chips.push(<Chip\n                style={{textOverflow: \"ellipsis\", maxWidth: 150}}\n                label={doc.name}\n                variant='outlined'\n                color={'secondary'}\n                key={docId}\n                onClick={() => window.open(doc.url, '_blank')}\n            />)\n        }\n    }\n    return chips\n}\n\nfunction NestedReplies({commentId, allLinkedInternalDocs, allLinkedExternalDocs, allComments, allUsers, nestingLevel, onUpdateDocument, onClick, onDelete, currentUsername}) {\n    const history = useHistory();\n    const comment = allComments[commentId]\n    const chips = generateDocumentChips(comment, allLinkedInternalDocs, allLinkedExternalDocs, history, onUpdateDocument)\n    if (!comment) {\n        return <></>\n    }\n    let shouldEnableDelete = false;\n    if (comment.author in allUsers) {\n        const authorRole = allUsers[comment.author]\n        if (authorRole === 'instructor' || comment.author === currentUsername) {\n            shouldEnableDelete = true;\n        }\n    }\n    const onClickDelete = e => {\n        e.stopPropagation()\n        onDelete(comment.id)\n    }\n    return (\n        <div>\n            <div className={'hover-card'} style={{padding: 10, borderBottom: '1px solid lightgray', cursor: 'pointer'}} onClick={() => onClick(commentId)}>\n                <div style={{display: \"flex\", alignItems: \"center\", marginBottom: 10}}>\n                    <p style={{margin: 0, fontWeight: 500, fontSize: 12}}>{comment.author}</p>\n                    {comment.author in allUsers && allUsers[comment.author] === 'instructor' && (\n                        <div style={{marginLeft: '10px'}}>\n                            <em style={{fontSize: 10, color: \"gray\"}}>Instructor</em>\n                        </div>\n                    )}\n\n                    {shouldEnableDelete && (\n                        <Button onClick={onClickDelete} style={{color: red['500'], marginLeft: \"auto\"}}>Delete</Button>\n                    )}\n                </div>\n                <p style={{margin: 0, marginBottom: 10, fontSize: 12}}>{comment.content}</p>\n                <div style={{display: 'flex', flexWrap: \"wrap\", gap: 10}}>\n                    {chips}\n                </div>\n            </div>\n            {comment.replies.length > 0 && (\n                <div style={{marginLeft: (nestingLevel + 1) * 15, borderLeft: `2px solid ${getHexGradient('#ffffff', '#1976d2', (nestingLevel + 1)/10)}`}}>\n                    {comment.replies.map(replyId => (\n                        <NestedReplies\n                            key={replyId}\n                            commentId={replyId}\n                            nestingLevel={nestingLevel + 1}\n                            allComments={allComments}\n                            allLinkedExternalDocs={allLinkedExternalDocs}\n                            allLinkedInternalDocs={allLinkedInternalDocs}\n                            allUsers={allUsers}\n                            onUpdateDocument={onUpdateDocument}\n                            onClick={onClick}\n                            onDelete={onDelete}\n                            currentUsername={currentUsername}\n                        />\n                    ))}\n                </div>\n            )}\n        </div>\n    )\n}\n\n\n\nexport function CommentDisplay({highlight, allLinkedInternalDocs, allLinkedExternalDocs, allComments, allUsers, onClickUpvote, onUpdateDocument, existingDocInfo, currentUsername, onAddComment, onDelete}) {\n    const [isUpvoted, setIsUpvoted] = useState(false)\n    const [clickedReply, setClickedReply] = useState(null)\n    const history = useHistory();\n    const selectedComment = allComments[highlight.commentId]\n    console.log('selectedComment', selectedComment)\n    const onThumbsUp = () => {\n        setIsUpvoted(!isUpvoted);\n        onClickUpvote(!isUpvoted);\n    }\n    let shouldEnableDelete = false;\n    if (selectedComment && selectedComment.author in allUsers) {\n        const authorRole = allUsers[selectedComment.author]\n        if (authorRole === 'instructor' || selectedComment.author === currentUsername) {\n            shouldEnableDelete = true;\n        }\n    }\n    const chips = generateDocumentChips(selectedComment, allLinkedInternalDocs, allLinkedExternalDocs, history, onUpdateDocument)\n    return (\n        <div style={{overflowY: 'hidden', height: '100%', display: 'flex', maxWidth: clickedReply ? 'initial' : '600px', minWidth: '500px', background: \"transparent\"}}>\n            <div style={{flexGrow: 1, display: 'flex', flexDirection: 'column', background: 'white', borderRadius: '4px', overflowY: 'auto'}}>\n                <div style={{display: 'flex', flexDirection: 'column', padding: 15}}>\n                    <section>\n                        <div style={{display: 'flex', alignItems: \"center\"}}>\n                            <h2 style={{fontWeight: 500, fontSize: 20, margin: 0}}>Highlight</h2>\n                            {(highlight.access === 'private' || selectedComment.access === 'private') && (\n                                <p style={{margin: 0, marginLeft: 15, color: 'gray', fontSize: 12}}>private</p>\n                            )}\n                            <IconButton style={{marginLeft: 'auto'}} onClick={onThumbsUp}>\n                                {isUpvoted ? <ThumbUp/> : <ThumbUpOutlined/>}\n                            </IconButton>\n                            {highlight.upvotes > 0 && (<span>{highlight.upvotes}</span>)}\n                            {shouldEnableDelete && (\n                                <Button onClick={() => onDelete(selectedComment.id)} style={{color: red['500']}}>Delete</Button>\n                            )}\n                        </div>\n                        <div style={{display: \"flex\", alignItems: 'center'}}>\n                            <p style={{margin: '5px 0'}}><span style={{fontSize: 14}}>{highlight.author}</span></p>\n                            {selectedComment && selectedComment.author in allUsers && allUsers[selectedComment.author] === 'instructor' && (\n                                <div style={{marginLeft: '10px'}}>\n                                    <em style={{fontSize: 10, color: \"gray\"}}>Instructor</em>\n                                </div>\n                            )}\n                        </div>\n                        <blockquote style={{margin: 0, padding: 5, background: '#f3f2f1', borderLeft: '2px solid darkgray'}}>\n                            <code style={{fontSize: 12}}>{highlight.selectedText.text}</code>\n                        </blockquote>\n                        <div>\n                            <h3 style={{fontWeight: 500, fontSize: 14, margin: 0, padding: '5px 0', marginTop: 10, background: '#ffff00', display: 'inline-block'}}>{selectedComment.title}</h3>\n                            <p style={{margin: 0, fontSize: 12}} dangerouslySetInnerHTML={{__html: markdownConverter.makeHtml(selectedComment.content)}}/>\n                        </div>\n                    </section>\n                    <section>\n                        <h2 style={{fontWeight: 500, fontSize: 20}}>Linked Documents</h2>\n                        <div style={{display: 'flex', flexWrap: \"wrap\", gap: 10}}>\n                            {chips}\n                        </div>\n                    </section>\n                    <section>\n                        <div style={{display: 'flex', alignItems: \"center\"}}>\n                            <h2 style={{fontWeight: 500, fontSize: 20}}>Discussion</h2>\n                            <IconButton style={{marginLeft: 'auto'}} onClick={() => setClickedReply(selectedComment.id)}><Add/></IconButton>\n                        </div>\n\n                        {selectedComment.replies.length > 0 && (\n                            <>\n                                {selectedComment.replies.map(replyId => (\n                                    <NestedReplies\n                                        key={replyId}\n                                        commentId={replyId}\n                                        nestingLevel={0}\n                                        allComments={allComments}\n                                        allLinkedExternalDocs={allLinkedExternalDocs}\n                                        allLinkedInternalDocs={allLinkedInternalDocs}\n                                        allUsers={allUsers}\n                                        onUpdateDocument={onUpdateDocument}\n                                        onClick={setClickedReply}\n                                        onDelete={onDelete}\n                                        currentUsername={currentUsername}\n                                    />\n                                ))}\n                            </>\n                        )}\n                    </section>\n                </div>\n            </div>\n            {clickedReply && (\n                <div style={{flexGrow: 1, display: 'flex', flexDirection: 'column', marginLeft: 20, borderRadius: '4px', overflowY: 'auto'}}>\n                    <CommentTip\n                        hasTitle={false}\n                        existingDocInfo={existingDocInfo}\n                        username={currentUsername}\n                        onAdd={data => {\n                            onAddComment(data, clickedReply)\n                            setClickedReply(false)\n                        }}\n                        onClose={() => setClickedReply(null)}\n                    />\n                </div>\n            )}\n        </div>\n    )\n}","import {\n    Button,\n    CircularProgress,\n    Dialog,\n    FormControl,\n    FormControlLabel, FormLabel,\n    IconButton, MenuItem, Radio, RadioGroup, Select, Switch,\n    TextField\n} from \"@material-ui/core\";\nimport {PDFViewer} from \"./pdf-viewer\";\nimport {useEffect, useState} from \"react\";\nimport {endpoints} from \"../network/endpoints\";\nimport {CommentDisplay, CommentMinimizedDisplay} from \"./comment-display\";\nimport {InfoOutlined, SettingsOutlined} from \"@material-ui/icons\";\nimport {blue} from \"@material-ui/core/colors\";\nimport {useHistory} from \"react-router-dom\";\nimport { v4 as uuidv4 } from 'uuid';\n\n\nfunction AppHeader({username, document, onUpdateDocument}) {\n    const [isDialogOpen, setIsDialogOpen] = useState(false);\n    const history = useHistory();\n    return (\n        <>\n            <div style={{background: 'black', width: '100%', display: 'flex', alignItems: 'center'}}>\n                <h2 onClick={() => history.push('/pdfs')} style={{color: 'white', fontSize: 18, padding: '5px 15px', margin: 0, fontWeight: 500, cursor: \"pointer\"}}>Document\n                    View</h2>\n                <IconButton style={{marginLeft: 'auto'}} onClick={() => setIsDialogOpen(true)}><InfoOutlined\n                    style={{color: 'white'}}/></IconButton>\n                <Button style={{\n                    color: '#fff1ff',\n                    textTransform: 'none',\n                    background: blue['700'],\n                    height: '100%',\n                    borderRadius: 0\n                }} onClick={() => window.location.reload()}>{username}</Button>\n            </div>\n            <Dialog open={isDialogOpen} onClose={() => setIsDialogOpen(false)}>\n                <DocumentInfo info={document} onUpdateInfo={onUpdateDocument}/>\n            </Dialog>\n        </>\n    )\n}\n\nfunction DocumentInfo({info, onUpdateInfo}) {\n    const [mode, setMode] = useState(null);\n    const [documentName, setDocumentName] = useState(info.name);\n    const onEdit = async () => {\n        if (mode === 'edit') {\n            const result = await endpoints.modifyDocument({name: documentName, id: info.id});\n            if (result) {\n                setMode(false);\n                onUpdateInfo(result);\n            }\n        } else {\n            setMode('edit');\n        }\n    }\n    return (\n        <div style={{padding: 15, width: 400}}>\n            <div style={{display: 'flex', flexDirection: 'row'}}>\n                <h1 style={{fontSize: 25, fontWeight: 500}}>Document Info</h1>\n                <Button style={{marginLeft: 'auto'}} onClick={onEdit}>{mode === 'edit' ? 'Done' : 'Edit'}</Button>\n            </div>\n            <div style={{display: 'flex', flexDirection: 'row'}}>\n                <p style={{width: 150}}><strong>Document Name</strong></p>\n                {mode === 'edit' ? <TextField value={documentName} onChange={e => setDocumentName(e.target.value)}/> :\n                    <p>{documentName}</p>}\n            </div>\n            <div style={{display: 'flex', flexDirection: 'row'}}>\n                <p style={{width: 150}}><strong>Author</strong></p>\n                <p>{info.author}</p>\n            </div>\n            <div style={{display: 'flex', flexDirection: 'row'}}>\n                <p style={{width: 150}}><strong>Creation Date</strong></p>\n                <p>{new Date(info.creationDate).toLocaleDateString(\"en-US\")}</p>\n            </div>\n        </div>\n    )\n}\n\nconst filterMode = Object.freeze({\n    self: 'self',\n    student: 'student',\n    instructor: 'instructor'\n})\n\nfunction generateSelection(mode, highlights, users) {\n    if (mode === filterMode.self) {\n        return [highlights, []];\n    }\n    const filteredHighlights = []\n    const filteredUsers = []\n    for (const highlight of highlights) {\n        const username = highlight.author\n        if (username in users) {\n            const user = users[username]\n            if ((mode === filterMode.student && user.role === 'student') || (mode === filterMode.instructor && user.role === 'instructor')) {\n                filteredHighlights.push(highlight)\n                filteredUsers.push(filteredUsers)\n            }\n        }\n    }\n    return [filteredHighlights, filteredUsers]\n}\n\nexport function DocumentViewer({username}) {\n    const {selectedDoc, existingDocInfo} = useHistory().location.state\n    const [document, setDocument] = useState(selectedDoc);\n    const [values, setValues] = useState({});\n    const [isSettingOpen, setIsSettingOpen] = useState(false);\n    const [highlightsFilter, setHighlightsFilter] = useState({author: '', mode: filterMode.self})\n    const [selectedHighlight, setSelectedHighlight] = useState(null);\n    const addHighlight = combined => {\n        console.log('combined-addHighlight', combined)\n        const time = Date.now()\n        const comment = {\n            id: `comment-${uuidv4().toString()}`,\n            content: combined.comment.content,\n            title: combined.comment.title,\n            access: combined.comment.access,\n            replies: [],\n            author: username,\n            linkedDocuments: combined.comment.links.map(l => l.id)\n        }\n        const highlight = {\n            selectedText: combined.selectedText,\n            position: combined.position,\n            id: `highlight-${uuidv4().toString()}`,\n            documentId: document.id,\n            author: username,\n            commentId: comment.id,\n            upvotes: 0,\n            access: comment.access\n        }\n        const externalLinks = [];\n        for (const link of combined.comment.links) {\n            if (link.isExternal) {\n                externalLinks.push({\n                    url: link.data.url,\n                    name: link.name,\n                    creationDate: time,\n                    author: username,\n                    id: link.id,\n                    lastUpdatedDate: time\n                })\n            }\n        }\n        endpoints.addHighlight(highlight, comment, externalLinks).then(({highlight, comment, externalDocs}) => {\n            setValues(old => {\n                const newValue = {...old};\n                newValue.highlights = [...newValue.highlights, highlight];\n                newValue.comments = {...newValue.comments, [comment.id]: comment}\n                newValue.linkedExternalResources = {...newValue.linkedExternalResources};\n                for (const d of externalDocs) {\n                    newValue.linkedExternalResources[d.id] = d\n                }\n                return newValue\n            })\n        })\n    };\n    const onUpvoteHighlight = shouldUpvote => {\n        endpoints.upvoteHighlight(selectedHighlight.id, !shouldUpvote).then(h => {\n            setValues(old => {\n                const newValues = {...old};\n                newValues.highlights = [...newValues.highlights];\n                let i = 0;\n                let isFound = false;\n                for (; i < newValues.highlights.length; i += 1) {\n                    if (newValues.highlights[i].id === h.id) {\n                        isFound = true;\n                        break;\n                    }\n                }\n                if (isFound) {\n                    newValues.highlights[i] = h;\n                }\n                return newValues\n            })\n            setSelectedHighlight(h)\n        })\n    }\n    const onUpdateDocument = setDocument\n    const onAddComment = (combined, targetId) => {\n        console.log('combined-addComment', combined)\n        const time = Date.now()\n        const comment = {\n            id: `comment-${uuidv4().toString()}`,\n            content: combined.content,\n            title: combined.title,\n            access: combined.access,\n            replies: [],\n            author: username,\n            linkedDocuments: combined.links.map(l => l.id)\n        }\n        const externalLinks = [];\n        for (const link of combined.links) {\n            if (link.isExternal) {\n                externalLinks.push({\n                    url: link.data.url,\n                    name: link.name,\n                    creationDate: time,\n                    author: username,\n                    id: link.id,\n                    lastUpdatedDate: time\n                })\n            }\n        }\n        endpoints.addComment(targetId, comment, externalLinks).then(({comment, externalDocs}) => {\n            setValues(old => {\n                const newValue = {...old};\n                newValue.comments = {...newValue.comments, [comment.id]: comment}\n                newValue.comments[targetId].replies.push(comment.id)\n                newValue.linkedExternalResources = {...newValue.linkedExternalResources};\n                for (const d of externalDocs) {\n                    newValue.linkedExternalResources[d.id] = d\n                }\n                return newValue\n            })\n        })\n    }\n    const onDeleteComment = id => {\n        endpoints.deleteComment(id).then(() => setValues(old => {\n            const newValues = {...old};\n            newValues.comments = {...newValues.comments}\n            delete newValues.comments[id]\n            return newValues\n        }))\n    }\n    useEffect(() => {\n        if (!document) {\n            return\n        }\n        console.log('selectedDocument', document)\n        endpoints.getAllHighlights(document.id, username).then(val => {\n            setSelectedHighlight(null)\n            setValues(val);\n        })\n    }, [document])\n    const [filteredHighlights, filteredUsers] = values.highlights ?\n        generateSelection(highlightsFilter.mode, values.highlights, values.users) : [[], []]\n    if (highlightsFilter.mode !== filterMode.self && highlightsFilter.author === '') {\n        filteredHighlights.length = 0\n    }\n    return (\n        <div style={{width: '100vw', height: '100vh', display: 'flex', flexDirection: 'column'}}>\n            <AppHeader username={username} document={document} onUpdateDocument={setDocument}/>\n            <div style={{display: 'flex', height: '100%'}}>\n                {document ? (\n                    <>\n                        <PDFViewer existingDocInfo={existingDocInfo} username={username} highlights={filteredHighlights}\n                                   url={document.url} onAddHighlight={addHighlight}/>\n                        <div style={{\n                            width: 'calc(40% - 1px)',\n                            borderLeft: '1px solid gray',\n                        }}>\n                            <div style={{padding: 10, background: '#e1dfdd'}}>\n                                <div style={{display: 'flex', flexDirection: 'row', alignItems: 'center'}}>\n                                    <h1 style={{fontSize: 25, fontWeight: 400, margin: 0}}>Highlights</h1>\n                                    <IconButton style={{marginLeft: 'auto'}}\n                                                onClick={() => setIsSettingOpen(s => !s)}><SettingsOutlined\n                                        style={{color: 'black'}}/></IconButton>\n                                </div>\n                                {isSettingOpen && (\n                                    <div style={{marginTop: 15}}>\n                                        <FormControl component=\"fieldset\">\n                                            <FormLabel component=\"legend\">Filter Highlights by Type</FormLabel>\n                                            <RadioGroup row={true} defaultValue={filterMode.self} aria-label=\"Filter Type\" name=\"Filter Type\" onChange={e => setHighlightsFilter({author: '', mode: e.target.value})}>\n                                                <FormControlLabel value={filterMode.self} control={<Radio />} label={<div style={{fontSize: 12}}>{username}</div>} />\n                                                <FormControlLabel value={filterMode.student} control={<Radio />} label={<div style={{fontSize: 12}}>Students</div>} />\n                                                <FormControlLabel value={filterMode.instructor} control={<Radio />} label={<div style={{fontSize: 12}}>Instructors</div>} />\n                                            </RadioGroup>\n                                        </FormControl>\n                                        {highlightsFilter.mode !== filterMode.self && (\n                                            <Select fullWidth value={highlightsFilter.author} onChange={e => setHighlightsFilter(old => ({...old, author: e.target.value}))}>\n                                                <MenuItem value=''>None</MenuItem>\n                                                {filteredUsers.map(u => (\n                                                    <MenuItem value={u.username}>{u.username}</MenuItem>\n                                                ))}\n                                            </Select>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            <div style={{padding: 10}}>\n                                {filteredHighlights.map(h => {\n                                    const comment = values.comments[h.commentId]\n                                    if (!comment) {\n                                        return null\n                                    }\n                                    return (\n                                        <CommentMinimizedDisplay\n                                            key={h.id}\n                                            username={comment.author}\n                                            title={comment.title}\n                                            content={comment.content}\n                                            onClick={() => setSelectedHighlight(h)}\n                                        />\n                                    )\n                                })}\n                            </div>\n                            {selectedHighlight && (\n                                <Dialog PaperProps={{style: {background: \"transparent\", maxHeight: '70vh'}}} maxWidth={false} open={selectedHighlight != null} onClose={() => setSelectedHighlight(null)}>\n                                    <CommentDisplay\n                                        allComments={values.comments}\n                                        allLinkedInternalDocs={values.linkedDocuments}\n                                        allLinkedExternalDocs={values.linkedExternalResources}\n                                        allUsers={values.users}\n                                        highlight={selectedHighlight}\n                                        onUpdateDocument={onUpdateDocument}\n                                        onClickUpvote={onUpvoteHighlight}\n                                        existingDocInfo={existingDocInfo}\n                                        currentUsername={username}\n                                        onAddComment={onAddComment}\n                                        onDelete={onDeleteComment}\n                                    />\n                                </Dialog>\n                            )}\n                        </div>\n                    </>\n                ) : (\n                    <div style={{display: 'flex', justifyContent: \"center\", alignItems: \"center\"}}>\n                        <CircularProgress />\n                    </div>\n                )}\n            </div>\n        </div>\n    )\n}","import {BrowserRouter as Router, Redirect, Route} from 'react-router-dom';\n\n\nimport './App.css';\nimport {Login, Register} from \"./components/authentication\";\nimport {useState} from \"react\";\nimport {DocumentSpace} from \"./components/document-space\";\nimport {createMuiTheme, MuiThemeProvider} from \"@material-ui/core\";\nimport {blue, blueGrey} from \"@material-ui/core/colors\";\nimport {DocumentViewer} from \"./components/document-viewer\";\n\nconst theme = createMuiTheme({\n    palette: {\n        primary: {\n            main: blueGrey[\"700\"]\n        },\n        secondary: {\n            main: blue['700']\n        }\n    },\n    typography: {\n        fontFamily: ['\"IBM Plex Sans\"', '\"Helvetica Neue\"', 'Arial', 'sans-serif'].join(', ')\n    }\n})\n\nfunction ProtectedRoute({username, path, defined, notDefined}) {\n    return (\n        <Route exact path={path}>\n            {username ? (defined) : (notDefined)}\n        </Route>\n    )\n}\n\nfunction App() {\n    const [user, setUser] = useState({});\n    return (\n        <MuiThemeProvider theme={theme}>\n            <Router>\n                <ProtectedRoute username={user.username} path={'/'} defined={<Redirect to={'/pdfs'}/>}\n                                notDefined={<Login onAuthenticated={setUser}/>}/>\n                <ProtectedRoute username={user.username} path={'/register'} defined={<Redirect to={'/pdfs'}/>}\n                                notDefined={<Register onAuthenticated={setUser}/>}/>\n                <ProtectedRoute username={user.username} path={'/pdfs'} defined={<DocumentSpace username={user.username} userRole={user.role}/>}\n                                notDefined={<Redirect to={'/'}/>}/>\n                <ProtectedRoute username={user.username} path={'/pdf/:id'} defined={<DocumentViewer username={user.username}/>}\n                                notDefined={<Redirect to={'/'}/>}/>\n            </Router>\n        </MuiThemeProvider>\n    );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}