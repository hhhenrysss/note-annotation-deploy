(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{109:function(e,t){},112:function(e,t){},160:function(e,t,n){},161:function(e,t,n){},188:function(e,t){},189:function(e,t){},190:function(e,t){},191:function(e,t){},192:function(e,t){},208:function(e,t){},219:function(e,t){},222:function(e,t){},223:function(e,t){},224:function(e,t){},282:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n.n(i),l=n(12),c=n.n(l),o=(n(160),n(15)),a=n(49),r=(n(161),n(28)),d=n.n(r);function j(e){return e.data.data}const u={login:async function(e,t){return j(await d.a.post("/api/login",{username:e,password:t}))},register:async function(e,t,n){return j(await d.a.post("/api/register",{username:e,password:t,role:n}))},getDocuments:async function(e){return j(await d.a.get("/api/pdfs",{params:{username:e}}))},modifyDocument:async function(e){return j(await d.a.post("/api/pdf/edit",e))},getAllHighlights:async function(e,t){return j(await d.a.get("/api/highlights",{params:{id:e,username:t}}))},createDocument:async function(e){return j(await d.a.post("/api/pdf/create",e))},addHighlight:async function(e,t,n){return j(await d.a.post("/api/highlight/add",{highlight:e,comment:t,externalDocs:n}))},upvoteHighlight:async function(e,t){return j(await d.a.post("/api/highlight/upvote",{id:e,isCancel:t}))},addComment:async function(e,t,n){return j(await d.a.post("/api/comment/add",{targetId:e,comment:t,externalDocs:n}))},deleteDocument:async function(e){return j(await d.a.post("/api/pdf/delete",{id:e}))},deleteComment:async function(e){return j(await d.a.post("/api/comment/delete",{id:e}))}};var h=n(312),x=n(338),m=n(318),b=n(319),f=n(339),g=n(342),O=n(336),p=n(1);function y({children:e,title:t,onRegisterClick:n}){return Object(p.jsxs)("div",{style:{width:"100%",height:"100%"},children:[Object(p.jsx)("section",{style:{display:"flex",flexDirection:"row",justifyContent:"center",height:"calc(40% - 25px)",width:"100%",background:"black",paddingBottom:25},children:Object(p.jsxs)("div",{style:{width:"40%",display:"flex",flexDirection:"row"},children:[Object(p.jsx)("h1",{style:{alignSelf:"flex-end",margin:0,padding:0,textAlign:"start",color:"white",fontWeight:300,fontSize:40},children:t}),n&&Object(p.jsx)(h.a,{onClick:n,style:{alignSelf:"flex-end",marginLeft:"auto",color:"white"},children:"Register"})]})}),Object(p.jsx)("section",{style:{display:"flex",justifyContent:"center",height:"calc(60% - 25px)",width:"100%",paddingTop:25},children:Object(p.jsx)("div",{style:{width:"40%"},children:e})})]})}function v({onAuthenticated:e}){const[t,n]=Object(i.useState)(null),[s,l]=Object(i.useState)(null),c=Object(o.f)();return Object(p.jsx)(y,{title:"Login",onRegisterClick:()=>c.push("/register"),children:Object(p.jsxs)("form",{children:[Object(p.jsx)("div",{style:{marginBottom:10},children:Object(p.jsx)(x.a,{fullWidth:!0,variant:"filled",label:"Username",onChange:e=>n(e.target.value)})}),Object(p.jsx)("div",{style:{marginBottom:20},children:Object(p.jsx)(x.a,{type:"password",fullWidth:!0,variant:"filled",label:"Password",onChange:e=>l(e.target.value)})}),Object(p.jsx)("div",{style:{display:"flex"},children:Object(p.jsx)(h.a,{onClick:()=>{t&&s&&u.login(t,s).then((t=>{t&&e(t)}))},style:{marginLeft:"auto"},children:"Submit"})})]})})}function D({onAuthenticated:e}){const[t,n]=Object(i.useState)(null),[s,l]=Object(i.useState)(null),[c,o]=Object(i.useState)("student");return Object(p.jsx)(y,{title:"Register",children:Object(p.jsxs)("form",{children:[Object(p.jsx)("div",{style:{marginBottom:10},children:Object(p.jsx)(x.a,{fullWidth:!0,variant:"filled",label:"Username",onChange:e=>n(e.target.value)})}),Object(p.jsx)("div",{style:{marginBottom:20},children:Object(p.jsx)(x.a,{type:"password",fullWidth:!0,variant:"filled",label:"Password",onChange:e=>l(e.target.value)})}),Object(p.jsx)("div",{style:{marginBottom:20},children:Object(p.jsxs)(m.a,{component:"fieldset",children:[Object(p.jsx)(b.a,{component:"legend",children:"Role"}),Object(p.jsxs)(f.a,{style:{display:"flex",flexDirection:"row"},"aria-label":"gender",name:"access-level",value:c,onChange:e=>o(e.target.value),children:[Object(p.jsx)(g.a,{value:"instructor",control:Object(p.jsx)(O.a,{}),label:"Instructor"}),Object(p.jsx)(g.a,{value:"student",control:Object(p.jsx)(O.a,{}),label:"Student"})]})]})}),Object(p.jsx)("div",{style:{display:"flex"},children:Object(p.jsx)(h.a,{onClick:()=>{t&&s&&c&&u.register(t,s,c).then((t=>{t&&e(t)}))},style:{marginLeft:"auto"},children:"Submit"})})]})})}var S=n(320),k=n(340),w=n(322),C=n(323),I=n(324),L=n(74),W=n(73),z=n(321),A=n(337);function U({onAdd:e,username:t}){const[n,s]=Object(i.useState)({}),l=(e,t)=>{s((n=>({...n,[t]:e.target.value})))};return Object(p.jsxs)("div",{style:{padding:15,minWidth:300},children:[Object(p.jsx)("h1",{style:{fontWeight:500,fontSize:20},children:"Add New Document"}),Object(p.jsxs)("form",{children:[Object(p.jsx)("div",{style:{marginBottom:10},children:Object(p.jsx)(x.a,{fullWidth:!0,label:"Document name",value:n.name,onChange:e=>l(e,"name")})}),Object(p.jsx)("div",{style:{marginBottom:20},children:Object(p.jsx)(x.a,{fullWidth:!0,label:"Url",value:n.url,onChange:e=>l(e,"url")})}),Object(p.jsx)("div",{style:{marginBottom:20},children:Object(p.jsxs)(m.a,{fullWidth:!0,component:"fieldset",children:[Object(p.jsx)(b.a,{component:"legend",children:"Role"}),Object(p.jsxs)(f.a,{style:{display:"flex",flexDirection:"row"},"aria-label":"gender",name:"access-level",value:n.access,onChange:e=>l(e,"access"),children:[Object(p.jsx)(g.a,{value:"private",control:Object(p.jsx)(O.a,{}),label:"Private"}),Object(p.jsx)(g.a,{value:"public",control:Object(p.jsx)(O.a,{}),label:"Public"})]})]})}),Object(p.jsx)("div",{style:{display:"flex"},children:Object(p.jsx)(h.a,{style:{marginLeft:"auto",marginRight:0},onClick:()=>{const i={...n};i.creationDate=Date.now(),i.lastUpdatedDate=Date.now(),i.author=t,i.id=`document-${Object(A.a)().toString()}`,e(i)},children:"Submit"})})]})]})}function R({username:e,onAddDocument:t}){const[n,s]=Object(i.useState)(!1);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{style:{background:"black",width:"100%",display:"flex",alignItems:"center",height:48},children:[Object(p.jsx)("h2",{style:{color:"white",fontSize:18,padding:"5px 15px",margin:0,fontWeight:500},children:"All Documents"}),Object(p.jsx)(S.a,{style:{marginLeft:"auto"},onClick:()=>s(!0),children:Object(p.jsx)(z.a,{style:{color:"white"}})}),Object(p.jsx)(h.a,{onClick:()=>window.location.reload(),style:{color:"#fff1ff",textTransform:"none",background:L.a[700],height:"100%",borderRadius:0},children:e})]}),Object(p.jsx)(k.a,{open:n,onClose:()=>s(!1),children:Object(p.jsx)(U,{onAdd:e=>{s(!1),t(e)},username:e})})]})}function T({info:e,existingDocInfo:t,onDelete:n}){const i=Object(o.f)();return Object(p.jsxs)(w.a,{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:220},children:[Object(p.jsxs)(C.a,{children:[Object(p.jsx)("h3",{style:{fontWeight:300,margin:0,marginBottom:10},children:e.name}),Object(p.jsxs)("p",{style:{margin:0,color:"gray"},children:["Uploaded by ",e.author]})]}),Object(p.jsxs)(I.a,{children:[Object(p.jsx)(h.a,{onClick:()=>{i.push(`/pdf/${e.id}`,{selectedDoc:e,existingDocInfo:t})},children:"View Document"}),n&&Object(p.jsx)(h.a,{onClick:n,style:{color:W.a[500],marginLeft:"auto"},children:"Delete"})]})]})}function B({username:e,userRole:t}){const[n,s]=Object(i.useState)([]);Object(i.useEffect)((()=>{u.getDocuments(e).then(s)}),[]);return Object(p.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column"},children:[Object(p.jsx)(R,{username:e,onAddDocument:e=>{u.createDocument(e).then((e=>s((t=>[...t,e]))))}}),Object(p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridGap:15,padding:15},children:n.map((i=>{let l=!1;return"student"===t?i.author===e&&(l=!0):l=!0,Object(p.jsx)(T,{info:i,existingDocInfo:n.map((({name:e,id:t})=>({name:e,id:t}))),onDelete:l?()=>{return e=i.id,void u.deleteDocument(e).then((()=>s((t=>{const n=[];for(const i of t)i.id!==e&&n.push(i);return n}))));var e}:null},i.id)}))})]})}var P=n(146),E=n(333),H=n(332),F=n(334),M=n(344),N=n(326),$=n(45),V=n(143),_=n(343),q=n(90),G=n.n(q);n(271);const Y=new(n(144).Converter)({tables:!0,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0});var J=n(145),K=n.n(J),Q=n(325);function X({onSelect:e,existingDocInfo:t}){const[n,s]=Object(i.useState)(""),[l,c]=Object(i.useState)([]);return Object(p.jsx)(K.a,{suggestions:l,getSuggestionValue:e=>e.name,onSuggestionsFetchRequested:({value:e})=>{c(t.filter((t=>t.name.toLowerCase().includes(e.toLowerCase()))))},onSuggestionsClearRequested:()=>c([]),renderSuggestion:e=>Object(p.jsx)("div",{style:{maxWidth:450,fontSize:12},children:e.name}),onSuggestionSelected:(t,{suggestion:n})=>e(n),inputProps:{placeholder:"Search resource name",value:n,onChange:(e,{newValue:t})=>s(t)},style:{fontSize:12},renderInputComponent:e=>Object(p.jsx)(x.a,{fullWidth:!0,inputProps:{style:{fontSize:12}},...e})})}function Z({onAdd:e,username:t}){const[n,s]=Object(i.useState)(""),[l,c]=Object(i.useState)("");return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{style:{marginBottom:10},children:Object(p.jsx)(x.a,{inputLabelProps:{style:{fontSize:12}},inputProps:{style:{fontSize:12}},fullWidth:!0,value:n,onChange:e=>s(e.target.value),label:"URL"})}),Object(p.jsx)("div",{style:{marginBottom:10},children:Object(p.jsx)(x.a,{inputLabelProps:{style:{fontSize:12}},inputProps:{style:{fontSize:12}},fullWidth:!0,value:l,onChange:e=>c(e.target.value),label:"Name"})}),Object(p.jsx)("div",{style:{display:"flex"},children:Object(p.jsx)(h.a,{style:{marginLeft:"auto"},onClick:()=>{e({url:n,name:l,creationDate:Date.now(),lastUpdatedDate:Date.now(),author:t,id:`external-${Object(A.a)().toString()}`})},children:"Add"})})]})}function ee({onAdd:e,onDelete:t,links:n,existingDocInfo:s,username:l}){const[c,o]=Object(i.useState)(!0);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(b.a,{component:"legend",style:{fontSize:12},children:"Links to resources"}),Object(p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:10,marginTop:10},children:n.map((e=>Object(p.jsx)(_.a,{style:{textOverflow:"ellipsis",maxWidth:150},variant:"outlined",label:e.name,onDelete:()=>t(e.id)},e.id)))}),Object(p.jsx)(h.a,{fullWidth:!0,onClick:()=>o((e=>!e)),children:c?"Add Link to External Resource":"Add Link to Internal Resource"}),c?Object(p.jsx)(X,{existingDocInfo:s,onSelect:({name:t,id:n})=>e({id:n,name:t},!1)}):Object(p.jsx)(Z,{username:l,onAdd:t=>e(t,!0)})]})}function te({onAdd:e,onOpen:t,username:n,existingDocInfo:s,hasTitle:l,onClose:c}){const[o,a]=Object(i.useState)(""),[r,d]=Object(i.useState)("write"),[j,u]=Object(i.useState)(""),[y,v]=Object(i.useState)("private"),[D,k]=Object(i.useState)([]);return Object(p.jsxs)("div",{style:{background:"rgba(255,255, 255, 0.8)",backdropFilter:"blur(10px)",padding:10,boxShadow:"0 6.4px 14.4px 0 rgb(0 0 0 / 13%), 0 1.2px 3.6px 0 rgb(0 0 0 / 11%)"},children:[Object(p.jsxs)("div",{style:{padding:"10px 0",display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(p.jsx)("h3",{style:{fontWeight:500,margin:0},children:"New comments"}),Object(p.jsx)(h.a,{style:{marginLeft:"auto"},onClick:()=>e({title:j,content:o,access:y,links:D}),children:"Post"}),c&&Object(p.jsx)(S.a,{onClick:c,children:Object(p.jsx)(Q.a,{})})]}),Object(p.jsxs)("form",{children:[l&&Object(p.jsx)(x.a,{style:{marginBottom:10},fullWidth:!0,label:"Title",value:j,onChange:e=>u(e.target.value)}),Object(p.jsx)("div",{style:{maxWidth:500,marginBottom:20},children:Object(p.jsx)(G.a,{value:o,onChange:a,selectedTab:r,onTabChange:d,generateMarkdownPreview:e=>Promise.resolve(Y.makeHtml(e))})}),Object(p.jsx)("br",{}),Object(p.jsx)("div",{style:{marginBottom:20},children:Object(p.jsxs)(m.a,{component:"fieldset",children:[Object(p.jsx)(b.a,{component:"legend",style:{fontSize:12},children:"Access Level"}),Object(p.jsxs)(f.a,{style:{display:"flex",flexDirection:"row"},"aria-label":"gender",name:"access-level",value:y,onChange:e=>v(e.target.value),children:[Object(p.jsx)(g.a,{style:{fontSize:12},value:"private",control:Object(p.jsx)(O.a,{}),label:Object(p.jsx)("span",{style:{fontSize:12},children:"Private"})}),Object(p.jsx)(g.a,{value:"public",control:Object(p.jsx)(O.a,{}),label:Object(p.jsx)("span",{style:{fontSize:12},children:"Public"})})]})]})}),Object(p.jsx)("br",{}),Object(p.jsx)("div",{style:{marginBottom:10},children:Object(p.jsx)(ee,{onAdd:(e,t)=>{k((n=>{const i=[...n];for(const{id:t}of i)if(t===e.id)return i;return i.push({name:e.name,id:e.id,isExternal:t,data:e}),i}))},onDelete:e=>{k((t=>t.filter((t=>t.id!==e))))},links:D,existingDocInfo:s,username:n})})]})]})}Object($.f)(V.a);const ne=()=>{document.location.hash=""};function ie(){return Object(p.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:Object(p.jsx)(N.a,{})})}function se({url:e,highlights:t,onAddHighlight:n,username:i,existingDocInfo:s}){return Object(p.jsx)("div",{style:{width:"100%",height:"100%",position:"relative"},children:Object(p.jsx)($.d,{url:e,beforeLoad:Object(p.jsx)(ie,{}),children:e=>Object(p.jsx)($.c,{pdfDocument:e,enableAreaSelection:e=>e.altKey,onScrollChange:ne,scrollRef:()=>{},onSelectionFinished:(e,t,l,c)=>Object(p.jsx)(te,{onOpen:c,onAdd:i=>{n({selectedText:t,position:e,comment:i}),l()},username:i,existingDocInfo:s,hasTitle:!0}),highlightTransform:(e,t,n,i,s,l,c)=>{const o=!Boolean(e.content&&e.content.image)?Object(p.jsx)($.b,{isScrolledTo:c,position:e.position,comment:e.comment}):Object(p.jsx)($.a,{highlight:e,onChange:e=>{}});return Object(p.jsx)($.e,{popupContent:Object(p.jsx)("div",{}),onMouseOver:t=>n(e,(e=>t)),onMouseOut:i,children:o},t)},highlights:t})})})}var le=n(327),ce=n(328),oe=n(329);function ae(e){const t=parseInt(e.replace("#",""),16);return[t>>16&255,t>>8&255,255&t]}function re(e,t,n){const i=n,s=1-i,l=ae(e),c=ae(t);return function(e){return"#"+e.map((e=>{const t=e.toString(16);return 1===t.length?"0"+t:t})).join("")}([Math.round(l[0]*i+c[0]*s),Math.round(l[1]*i+c[1]*s),Math.round(l[2]*i+c[2]*s)])}function de({title:e,username:t,content:n,onClick:i}){return Object(p.jsxs)("div",{className:"hover-card",onClick:i,style:{padding:10,borderBottom:"1px solid #c7c7c7",cursor:"pointer"},children:[Object(p.jsx)("h6",{style:{fontSize:15,margin:"5px 0"},children:e}),Object(p.jsx)("p",{style:{fontSize:12,color:"gray",marginBottom:5,margin:0,padding:"5px 0"},children:t}),Object(p.jsx)("div",{style:{fontSize:12,margin:0,padding:0},dangerouslySetInnerHTML:{__html:Y.makeHtml(n)}})]})}function je(e,t,n,i,s){const l=[];if(!e)return[];for(const c of e.linkedDocuments)if(c in t){const e=t[c];l.push(Object(p.jsx)(_.a,{style:{textOverflow:"ellipsis",maxWidth:150},label:e.name,variant:"outlined",color:"secondary",onClick:()=>s(e)},c))}else if(c in n){const e=n[c];l.push(Object(p.jsx)(_.a,{style:{textOverflow:"ellipsis",maxWidth:150},label:e.name,variant:"outlined",color:"secondary",onClick:()=>window.open(e.url,"_blank")},c))}return l}function ue({commentId:e,allLinkedInternalDocs:t,allLinkedExternalDocs:n,allComments:i,allUsers:s,nestingLevel:l,onUpdateDocument:c,onClick:a,onDelete:r,currentUsername:d}){Object(o.f)();const j=i[e],u=je(j,t,n,0,c);if(!j)return Object(p.jsx)(p.Fragment,{});let x=!1;if(j.author in s){"instructor"!==s[j.author]&&j.author!==d||(x=!0)}return Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{className:"hover-card",style:{padding:10,borderBottom:"1px solid lightgray",cursor:"pointer"},onClick:()=>a(e),children:[Object(p.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:10},children:[Object(p.jsx)("p",{style:{margin:0,fontWeight:500,fontSize:12},children:j.author}),j.author in s&&"instructor"===s[j.author]&&Object(p.jsx)("div",{style:{marginLeft:"10px"},children:Object(p.jsx)("em",{style:{fontSize:10,color:"gray"},children:"Instructor"})}),x&&Object(p.jsx)(h.a,{onClick:e=>{e.stopPropagation(),r(j.id)},style:{color:W.a[500],marginLeft:"auto"},children:"Delete"})]}),Object(p.jsx)("p",{style:{margin:0,marginBottom:10,fontSize:12},children:j.content}),Object(p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:u})]}),j.replies.length>0&&Object(p.jsx)("div",{style:{marginLeft:15*(l+1),borderLeft:`2px solid ${re("#ffffff","#1976d2",(l+1)/10)}`},children:j.replies.map((e=>Object(p.jsx)(ue,{commentId:e,nestingLevel:l+1,allComments:i,allLinkedExternalDocs:n,allLinkedInternalDocs:t,allUsers:s,onUpdateDocument:c,onClick:a,onDelete:r,currentUsername:d},e)))})]})}function he({highlight:e,allLinkedInternalDocs:t,allLinkedExternalDocs:n,allComments:s,allUsers:l,onClickUpvote:c,onUpdateDocument:a,existingDocInfo:r,currentUsername:d,onAddComment:j,onDelete:u}){const[x,m]=Object(i.useState)(!1),[b,f]=Object(i.useState)(null),g=(Object(o.f)(),s[e.commentId]);console.log("selectedComment",g);let O=!1;if(g&&g.author in l){"instructor"!==l[g.author]&&g.author!==d||(O=!0)}const y=je(g,t,n,0,a);return Object(p.jsxs)("div",{style:{overflowY:"hidden",height:"100%",display:"flex",maxWidth:b?"initial":"600px",minWidth:"500px",background:"transparent"},children:[Object(p.jsx)("div",{style:{flexGrow:1,display:"flex",flexDirection:"column",background:"white",borderRadius:"4px",overflowY:"auto"},children:Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:15},children:[Object(p.jsxs)("section",{children:[Object(p.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(p.jsx)("h2",{style:{fontWeight:500,fontSize:20,margin:0},children:"Highlight"}),("private"===e.access||"private"===g.access)&&Object(p.jsx)("p",{style:{margin:0,marginLeft:15,color:"gray",fontSize:12},children:"private"}),Object(p.jsx)(S.a,{style:{marginLeft:"auto"},onClick:()=>{m(!x),c(!x)},children:x?Object(p.jsx)(le.a,{}):Object(p.jsx)(ce.a,{})}),e.upvotes>0&&Object(p.jsx)("span",{children:e.upvotes}),O&&Object(p.jsx)(h.a,{onClick:()=>u(g.id),style:{color:W.a[500]},children:"Delete"})]}),Object(p.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(p.jsx)("p",{style:{margin:"5px 0"},children:Object(p.jsx)("span",{style:{fontSize:14},children:e.author})}),g&&g.author in l&&"instructor"===l[g.author]&&Object(p.jsx)("div",{style:{marginLeft:"10px"},children:Object(p.jsx)("em",{style:{fontSize:10,color:"gray"},children:"Instructor"})})]}),Object(p.jsx)("blockquote",{style:{margin:0,padding:5,background:"#f3f2f1",borderLeft:"2px solid darkgray"},children:Object(p.jsx)("code",{style:{fontSize:12},children:e.selectedText.text})}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{style:{fontWeight:500,fontSize:14,margin:0,padding:"5px 0",marginTop:10,background:"#ffff00",display:"inline-block"},children:g.title}),Object(p.jsx)("p",{style:{margin:0,fontSize:12},dangerouslySetInnerHTML:{__html:Y.makeHtml(g.content)}})]})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)("h2",{style:{fontWeight:500,fontSize:20},children:"Linked Documents"}),Object(p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:y})]}),Object(p.jsxs)("section",{children:[Object(p.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(p.jsx)("h2",{style:{fontWeight:500,fontSize:20},children:"Discussion"}),Object(p.jsx)(S.a,{style:{marginLeft:"auto"},onClick:()=>f(g.id),children:Object(p.jsx)(oe.a,{})})]}),g.replies.length>0&&Object(p.jsx)(p.Fragment,{children:g.replies.map((e=>Object(p.jsx)(ue,{commentId:e,nestingLevel:0,allComments:s,allLinkedExternalDocs:n,allLinkedInternalDocs:t,allUsers:l,onUpdateDocument:a,onClick:f,onDelete:u,currentUsername:d},e)))})]})]})}),b&&Object(p.jsx)("div",{style:{flexGrow:1,display:"flex",flexDirection:"column",marginLeft:20,borderRadius:"4px",overflowY:"auto"},children:Object(p.jsx)(te,{hasTitle:!1,existingDocInfo:r,username:d,onAdd:e=>{j(e,b),f(!1)},onClose:()=>f(null)})})]})}var xe=n(330),me=n(331);function be({username:e,document:t,onUpdateDocument:n}){const[s,l]=Object(i.useState)(!1),c=Object(o.f)();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{style:{background:"black",width:"100%",display:"flex",alignItems:"center"},children:[Object(p.jsx)("h2",{onClick:()=>c.push("/pdfs"),style:{color:"white",fontSize:18,padding:"5px 15px",margin:0,fontWeight:500,cursor:"pointer"},children:"Document View"}),Object(p.jsx)(S.a,{style:{marginLeft:"auto"},onClick:()=>l(!0),children:Object(p.jsx)(xe.a,{style:{color:"white"}})}),Object(p.jsx)(h.a,{style:{color:"#fff1ff",textTransform:"none",background:L.a[700],height:"100%",borderRadius:0},onClick:()=>window.location.reload(),children:e})]}),Object(p.jsx)(k.a,{open:s,onClose:()=>l(!1),children:Object(p.jsx)(fe,{info:t,onUpdateInfo:n})})]})}function fe({info:e,onUpdateInfo:t}){const[n,s]=Object(i.useState)(null),[l,c]=Object(i.useState)(e.name);return Object(p.jsxs)("div",{style:{padding:15,width:400},children:[Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(p.jsx)("h1",{style:{fontSize:25,fontWeight:500},children:"Document Info"}),Object(p.jsx)(h.a,{style:{marginLeft:"auto"},onClick:async()=>{if("edit"===n){const n=await u.modifyDocument({name:l,id:e.id});n&&(s(!1),t(n))}else s("edit")},children:"edit"===n?"Done":"Edit"})]}),Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(p.jsx)("p",{style:{width:150},children:Object(p.jsx)("strong",{children:"Document Name"})}),"edit"===n?Object(p.jsx)(x.a,{value:l,onChange:e=>c(e.target.value)}):Object(p.jsx)("p",{children:l})]}),Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(p.jsx)("p",{style:{width:150},children:Object(p.jsx)("strong",{children:"Author"})}),Object(p.jsx)("p",{children:e.author})]}),Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(p.jsx)("p",{style:{width:150},children:Object(p.jsx)("strong",{children:"Creation Date"})}),Object(p.jsx)("p",{children:new Date(e.creationDate).toLocaleDateString("en-US")})]})]})}const ge=Object.freeze({self:"self",student:"student",instructor:"instructor"});function Oe({username:e}){const{selectedDoc:t,existingDocInfo:n}=Object(o.f)().location.state,[s,l]=Object(i.useState)(t),[c,a]=Object(i.useState)({}),[r,d]=Object(i.useState)(!1),[j,h]=Object(i.useState)({author:"",mode:ge.self}),[x,y]=Object(i.useState)(null),v=l;Object(i.useEffect)((()=>{s&&(console.log("selectedDocument",s),u.getAllHighlights(s.id,e).then((e=>{y(null),a(e)})))}),[s]);const[D,w]=c.highlights?function(e,t,n){if(e===ge.self)return[t,[]];const i=[],s=[];for(const l of t){const t=l.author;if(t in n){const c=n[t];(e===ge.student&&"student"===c.role||e===ge.instructor&&"instructor"===c.role)&&(i.push(l),s.push(s))}}return[i,s]}(j.mode,c.highlights,c.users):[[],[]];return j.mode!==ge.self&&""===j.author&&(D.length=0),Object(p.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column"},children:[Object(p.jsx)(be,{username:e,document:s,onUpdateDocument:l}),Object(p.jsx)("div",{style:{display:"flex",height:"100%"},children:s?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(se,{existingDocInfo:n,username:e,highlights:D,url:s.url,onAddHighlight:t=>{console.log("combined-addHighlight",t);const n=Date.now(),i={id:`comment-${Object(A.a)().toString()}`,content:t.comment.content,title:t.comment.title,access:t.comment.access,replies:[],author:e,linkedDocuments:t.comment.links.map((e=>e.id))},l={selectedText:t.selectedText,position:t.position,id:`highlight-${Object(A.a)().toString()}`,documentId:s.id,author:e,commentId:i.id,upvotes:0,access:i.access},c=[];for(const s of t.comment.links)s.isExternal&&c.push({url:s.data.url,name:s.name,creationDate:n,author:e,id:s.id,lastUpdatedDate:n});u.addHighlight(l,i,c).then((({highlight:e,comment:t,externalDocs:n})=>{a((i=>{const s={...i};s.highlights=[...s.highlights,e],s.comments={...s.comments,[t.id]:t},s.linkedExternalResources={...s.linkedExternalResources};for(const e of n)s.linkedExternalResources[e.id]=e;return s}))}))}}),Object(p.jsxs)("div",{style:{width:"calc(40% - 1px)",borderLeft:"1px solid gray"},children:[Object(p.jsxs)("div",{style:{padding:10,background:"#e1dfdd"},children:[Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(p.jsx)("h1",{style:{fontSize:25,fontWeight:400,margin:0},children:"Highlights"}),Object(p.jsx)(S.a,{style:{marginLeft:"auto"},onClick:()=>d((e=>!e)),children:Object(p.jsx)(me.a,{style:{color:"black"}})})]}),r&&Object(p.jsxs)("div",{style:{marginTop:15},children:[Object(p.jsxs)(m.a,{component:"fieldset",children:[Object(p.jsx)(b.a,{component:"legend",children:"Filter Highlights by Type"}),Object(p.jsxs)(f.a,{row:!0,defaultValue:ge.self,"aria-label":"Filter Type",name:"Filter Type",onChange:e=>h({author:"",mode:e.target.value}),children:[Object(p.jsx)(g.a,{value:ge.self,control:Object(p.jsx)(O.a,{}),label:Object(p.jsx)("div",{style:{fontSize:12},children:e})}),Object(p.jsx)(g.a,{value:ge.student,control:Object(p.jsx)(O.a,{}),label:Object(p.jsx)("div",{style:{fontSize:12},children:"Students"})}),Object(p.jsx)(g.a,{value:ge.instructor,control:Object(p.jsx)(O.a,{}),label:Object(p.jsx)("div",{style:{fontSize:12},children:"Instructors"})})]})]}),j.mode!==ge.self&&Object(p.jsxs)(F.a,{fullWidth:!0,value:j.author,onChange:e=>h((t=>({...t,author:e.target.value}))),children:[Object(p.jsx)(M.a,{value:"",children:"None"}),w.map((e=>Object(p.jsx)(M.a,{value:e.username,children:e.username})))]})]})]}),Object(p.jsx)("div",{style:{padding:10},children:D.map((e=>{const t=c.comments[e.commentId];return t?Object(p.jsx)(de,{username:t.author,title:t.title,content:t.content,onClick:()=>y(e)},e.id):null}))}),x&&Object(p.jsx)(k.a,{PaperProps:{style:{background:"transparent",maxHeight:"70vh"}},maxWidth:!1,open:null!=x,onClose:()=>y(null),children:Object(p.jsx)(he,{allComments:c.comments,allLinkedInternalDocs:c.linkedDocuments,allLinkedExternalDocs:c.linkedExternalResources,allUsers:c.users,highlight:x,onUpdateDocument:v,onClickUpvote:e=>{u.upvoteHighlight(x.id,!e).then((e=>{a((t=>{const n={...t};n.highlights=[...n.highlights];let i=0,s=!1;for(;i<n.highlights.length;i+=1)if(n.highlights[i].id===e.id){s=!0;break}return s&&(n.highlights[i]=e),n})),y(e)}))},existingDocInfo:n,currentUsername:e,onAddComment:(t,n)=>{console.log("combined-addComment",t);const i=Date.now(),s={id:`comment-${Object(A.a)().toString()}`,content:t.content,title:t.title,access:t.access,replies:[],author:e,linkedDocuments:t.links.map((e=>e.id))},l=[];for(const c of t.links)c.isExternal&&l.push({url:c.data.url,name:c.name,creationDate:i,author:e,id:c.id,lastUpdatedDate:i});u.addComment(n,s,l).then((({comment:e,externalDocs:t})=>{a((i=>{const s={...i};s.comments={...s.comments,[e.id]:e},s.comments[n].replies.push(e.id),s.linkedExternalResources={...s.linkedExternalResources};for(const e of t)s.linkedExternalResources[e.id]=e;return s}))}))},onDelete:e=>{u.deleteComment(e).then((()=>a((t=>{const n={...t};return n.comments={...n.comments},delete n.comments[e],n}))))}})})]})]}):Object(p.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(p.jsx)(N.a,{})})})]})}const pe=Object(P.a)({palette:{primary:{main:H.a[700]},secondary:{main:L.a[700]}},typography:{fontFamily:['"IBM Plex Sans"','"Helvetica Neue"',"Arial","sans-serif"].join(", ")}});function ye({username:e,path:t,defined:n,notDefined:i}){return Object(p.jsx)(o.b,{exact:!0,path:t,children:e?n:i})}var ve=function(){const[e,t]=Object(i.useState)({});return Object(p.jsx)(E.a,{theme:pe,children:Object(p.jsxs)(a.a,{children:[Object(p.jsx)(ye,{username:e.username,path:"/",defined:Object(p.jsx)(o.a,{to:"/pdfs"}),notDefined:Object(p.jsx)(v,{onAuthenticated:t})}),Object(p.jsx)(ye,{username:e.username,path:"/register",defined:Object(p.jsx)(o.a,{to:"/pdfs"}),notDefined:Object(p.jsx)(D,{onAuthenticated:t})}),Object(p.jsx)(ye,{username:e.username,path:"/pdfs",defined:Object(p.jsx)(B,{username:e.username,userRole:e.role}),notDefined:Object(p.jsx)(o.a,{to:"/"})}),Object(p.jsx)(ye,{username:e.username,path:"/pdf/:id",defined:Object(p.jsx)(Oe,{username:e.username}),notDefined:Object(p.jsx)(o.a,{to:"/"})})]})})};var De=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,346)).then((({getCLS:t,getFID:n,getFCP:i,getLCP:s,getTTFB:l})=>{t(e),n(e),i(e),s(e),l(e)}))};c.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(ve,{})}),document.getElementById("root")),De()}},[[282,1,2]]]);
//# sourceMappingURL=main.ce88f34d.chunk.js.map